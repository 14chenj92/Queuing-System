<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Badminton Court Booking System</title>
  <link rel="stylesheet" href="reset.css" />
  <link rel="stylesheet" href="main.css" />
</head>
<body>
    <button onclick="goToHome()" class="back-button">â¬… Back </button>
    <h1>Login</h1>
    <div class="login-box">
      <label for="login">Email:</label>
      <input type="text" id="login" name="login" required />
      <br /><br />
      <a href="#" id="login-check" class="cta">
          <span>Login</span>
          <svg width="15px" height="10px" viewBox="0 0 13 10">
            <path d="M1,5 L11,5"></path>
            <polyline points="8 1 12 5 8 9"></polyline>
          </svg>
      </a>
    </div>
    <script src="function.js"></script>
    <script src="script.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.8.0/dist/sweetalert2.all.min.js"></script>
    <script>
      document.getElementById('login-check').addEventListener('click', function(event) {
        event.preventDefault(); 
        const loginID = document.getElementById('login').value; 
  

        fetch("/check-email", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify({ loginID: loginID })  
        })
        .then(response => response.json())
        .then(data => {
          if (data.exists) {
            fetch(`/update-signin-status`, {
      method: "PUT",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({ loginID: loginID, isSignedIn: 1 })  // Send the loginID and new isSignedIn status
    })
            window.location.href = "booking.html";
          } else {
            Swal.fire({
              title: "Error",
              text: "This email does not exist. Please register before logging in.",
              icon: "error",
              confirmButtonText: "OK"
            });
          }
        })
        .catch(error => {
          console.error("Error:", error);
          Swal.fire({
            title: "Error",
            text: "There was an issue with the server. Please try again later.",
            icon: "error",
            confirmButtonText: "OK"
          });
        });
      });
    </script>
      <script>
        function goToHome() {
          window.location.href = "main.html";
        }
      </script>  
  </body>
  
</html>