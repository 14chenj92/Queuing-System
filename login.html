<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Badminton Court Booking System</title>
  <link rel="stylesheet" href="reset.css" />
  <link rel="stylesheet" href="main.css" />
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <button onclick="goToHome()" class="back-button">â¬… Back </button>
  <div class="login-box">
    <h2>Login</h2>
    <label for="email">Email:</label>
    <input type="email" id="email" name="email" required />
    <br /><br />
    <button id="login-check" class="cta" onclick="login()">
        <span>Login</span>
        <svg width="15px" height="10px" viewBox="0 0 13 10">
            <path d="M1,5 L11,5"></path>
            <polyline points="8 1 12 5 8 9"></polyline>
          </svg>
    </button>
  </div>
  <script src="function.js"></script>
  <script src="script.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.8.0/dist/sweetalert2.all.min.js"></script>
  <script>
async function login() {
    const email = document.getElementById("email").value;

    if (!email) {
        Swal.fire({
            icon: 'error',
            title: 'Error',
            text: 'Please enter a valid email address.'
        });
        return;
    }

    // Send the login request to the server
    const response = await fetch("/login", {
        method: "POST",
        body: JSON.stringify({ email }),
        headers: {
            "Content-Type": "application/json"
        }
    });

    const result = await response.json();

    // Handle the result based on the user's status
    if (result.status === "approved") {
        Swal.fire({
            icon: 'success',
            title: 'Login Approved',
            html: `You are now logged in. \n
            Your password for today is <strong style="color: green;">${result.password}</strong>`,
        })
        .then(() => {
            // Redirect after SweetAlert
            window.location.href = "booking.html";
        });
    } else if (result.status === "pending") {
      Swal.fire({
            icon: 'info',
            title: 'Pending Approval',
            text: 'Your login request is pending approval by the admin.'
        })
    } else {
        Swal.fire({
            icon: 'error',
            title: 'Login Failed',
            text: 'Email not found.'
        });
    }
}

    function goToHome() {
      window.location.href = "main.html";
    }
  </script>
</body>
</html>
